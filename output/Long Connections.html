<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>Long Connections</title><link href='https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; tab-size: 4; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 40px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 2; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px !important; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-diagram-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  html.blink-to-pdf { font-size: 13px; }
  .typora-export #write { padding-left: 32px; padding-right: 32px; padding-bottom: 0px; break-after: avoid; }
  .typora-export #write::after { height: 0px; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
[contenteditable="true"]:active, [contenteditable="true"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.html-for-mac .inline-math-svg .MathJax_SVG { vertical-align: 0.2px; }
.md-math-block .MathJax_SVG_Display { text-align: center; margin: 0px; position: relative; text-indent: 0px; max-width: none; max-height: none; min-height: 0px; min-width: 100%; width: auto; overflow-y: hidden; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: var(--monospace); }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: 400; line-height: normal; zoom: 90%; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; }
.MathJax_SVG * { transition: none 0s ease 0s; }
.MathJax_SVG_Display svg { vertical-align: middle !important; margin-bottom: 0px !important; margin-top: 0px !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="mermaid"] svg, [lang="flow"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 30px; z-index: 3; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


:root { --side-bar-bg-color: #fafafa; --control-text-color: #777; }
html { font-size: 16px; }
body { font-family: "Open Sans", "Clear Sans", "Helvetica Neue", Helvetica, Arial, sans-serif; color: rgb(51, 51, 51); line-height: 1.6; }
#write { max-width: 860px; margin: 0px auto; padding: 30px 30px 100px; }
#write > ul:first-child, #write > ol:first-child { margin-top: 30px; }
a { color: rgb(65, 131, 196); }
h1, h2, h3, h4, h5, h6 { position: relative; margin-top: 1rem; margin-bottom: 1rem; font-weight: bold; line-height: 1.4; cursor: text; }
h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor { text-decoration: none; }
h1 tt, h1 code { font-size: inherit; }
h2 tt, h2 code { font-size: inherit; }
h3 tt, h3 code { font-size: inherit; }
h4 tt, h4 code { font-size: inherit; }
h5 tt, h5 code { font-size: inherit; }
h6 tt, h6 code { font-size: inherit; }
h1 { padding-bottom: 0.3em; font-size: 2.25em; line-height: 1.2; border-bottom: 1px solid rgb(238, 238, 238); }
h2 { padding-bottom: 0.3em; font-size: 1.75em; line-height: 1.225; border-bottom: 1px solid rgb(238, 238, 238); }
h3 { font-size: 1.5em; line-height: 1.43; }
h4 { font-size: 1.25em; }
h5 { font-size: 1em; }
h6 { font-size: 1em; color: rgb(119, 119, 119); }
p, blockquote, ul, ol, dl, table { margin: 0.8em 0px; }
li > ol, li > ul { margin: 0px; }
hr { height: 2px; padding: 0px; margin: 16px 0px; background-color: rgb(231, 231, 231); border: 0px none; overflow: hidden; box-sizing: content-box; }
li p.first { display: inline-block; }
ul, ol { padding-left: 30px; }
ul:first-child, ol:first-child { margin-top: 0px; }
ul:last-child, ol:last-child { margin-bottom: 0px; }
blockquote { border-left: 4px solid rgb(223, 226, 229); padding: 0px 15px; color: rgb(119, 119, 119); }
blockquote blockquote { padding-right: 0px; }
table { padding: 0px; word-break: initial; }
table tr { border-top: 1px solid rgb(223, 226, 229); margin: 0px; padding: 0px; }
table tr:nth-child(2n), thead { background-color: rgb(248, 248, 248); }
table tr th { font-weight: bold; border-width: 1px 1px 0px; border-top-style: solid; border-right-style: solid; border-left-style: solid; border-top-color: rgb(223, 226, 229); border-right-color: rgb(223, 226, 229); border-left-color: rgb(223, 226, 229); border-image: initial; border-bottom-style: initial; border-bottom-color: initial; margin: 0px; padding: 6px 13px; }
table tr td { border: 1px solid rgb(223, 226, 229); margin: 0px; padding: 6px 13px; }
table tr th:first-child, table tr td:first-child { margin-top: 0px; }
table tr th:last-child, table tr td:last-child { margin-bottom: 0px; }
.CodeMirror-lines { padding-left: 4px; }
.code-tooltip { box-shadow: rgba(0, 28, 36, 0.3) 0px 1px 1px 0px; border-top: 1px solid rgb(238, 242, 242); }
.md-fences, code, tt { border: 1px solid rgb(231, 234, 237); background-color: rgb(248, 248, 248); border-radius: 3px; padding: 2px 4px 0px; font-size: 0.9em; }
code { background-color: rgb(243, 244, 244); padding: 0px 2px; }
.md-fences { margin-bottom: 15px; margin-top: 15px; padding-top: 8px; padding-bottom: 6px; }
.md-task-list-item > input { margin-left: -1.3em; }
@media print {
  html { font-size: 13px; }
  table, pre { break-inside: avoid; }
  pre { overflow-wrap: break-word; }
}
.md-fences { background-color: rgb(248, 248, 248); }
#write pre.md-meta-block { padding: 1rem; font-size: 85%; line-height: 1.45; background-color: rgb(247, 247, 247); border: 0px; border-radius: 3px; color: rgb(119, 119, 119); margin-top: 0px !important; }
.mathjax-block > .code-tooltip { bottom: 0.375rem; }
.md-mathjax-midline { background: rgb(250, 250, 250); }
#write > h3.md-focus::before { left: -1.5625rem; top: 0.375rem; }
#write > h4.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
#write > h5.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
#write > h6.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
.md-image > .md-meta { border-radius: 3px; padding: 2px 0px 0px 4px; font-size: 0.9em; color: inherit; }
.md-tag { color: rgb(167, 167, 167); opacity: 1; }
.md-toc { margin-top: 20px; padding-bottom: 20px; }
.sidebar-tabs { border-bottom: none; }
#typora-quick-open { border: 1px solid rgb(221, 221, 221); background-color: rgb(248, 248, 248); }
#typora-quick-open-item { background-color: rgb(250, 250, 250); border-color: rgb(254, 254, 254) rgb(229, 229, 229) rgb(229, 229, 229) rgb(238, 238, 238); border-style: solid; border-width: 1px; }
.on-focus-mode blockquote { border-left-color: rgba(85, 85, 85, 0.12); }
header, .context-menu, .megamenu-content, footer { font-family: "Segoe UI", Arial, sans-serif; }
.file-node-content:hover .file-node-icon, .file-node-content:hover .file-node-open-state { visibility: visible; }
.mac-seamless-mode #typora-sidebar { background-color: var(--side-bar-bg-color); }
.md-lang { color: rgb(180, 101, 77); }
.html-for-mac .context-menu { --item-hover-bg-color: #E6F0FE; }
#md-notification .btn { border: 0px; }
.dropdown-menu .divider { border-color: rgb(229, 229, 229); }
.ty-preferences .window-content { background-color: rgb(250, 250, 250); }
.ty-preferences .nav-group-item.active { color: white; background: rgb(153, 153, 153); }


</style>
</head>
<body class='typora-export' >
<div  id='write'  class = 'is-node'><h1><a name="long-connections" class="md-header-anchor"></a><span>Long Connections</span></h1><div class='md-toc' mdtype='toc'><p class="md-toc-content"><span class="md-toc-item md-toc-h1" data-ref="n0"><a class="md-toc-inner" href="#long-connections">Long Connections</a></span><span class="md-toc-item md-toc-h2" data-ref="n3"><a class="md-toc-inner" href="#goal">Goal</a></span><span class="md-toc-item md-toc-h2" data-ref="n5"><a class="md-toc-inner" href="#tools-used">Tools Used</a></span><span class="md-toc-item md-toc-h2" data-ref="n13"><a class="md-toc-inner" href="#background">Background</a></span><span class="md-toc-item md-toc-h2" data-ref="n30"><a class="md-toc-inner" href="#hunt">Hunt</a></span><span class="md-toc-item md-toc-h3" data-ref="n32"><a class="md-toc-inner" href="#wireshark">Wireshark</a></span><span class="md-toc-item md-toc-h3" data-ref="n42"><a class="md-toc-inner" href="#zeek">Zeek</a></span><span class="md-toc-item md-toc-h4" data-ref="n74"><a class="md-toc-inner" href="#cummulative-long-connections">Cummulative Long Connections</a></span><span class="md-toc-item md-toc-h3" data-ref="n101"><a class="md-toc-inner" href="#rita">RITA</a></span></p></div><h2><a name="goal" class="md-header-anchor"></a><span>Goal</span></h2><p><span>Identify the long-lived network connections.</span></p><h2><a name="tools-used" class="md-header-anchor"></a><span>Tools Used</span></h2><ul><li><span>Wireshark</span></li><li><span>Zeek</span></li><li><span>RITA</span></li></ul><h2><a name="background" class="md-header-anchor"></a><span>Background</span></h2><p><span>To determine how long a connection stays open, we first need to define what constitutes the start or end of a connection. </span></p><p><span>For TCP, a typical connection starts with a 3-way handshake (SYN, SYN/ACK, ACK) and ends with a 4-way handshake (FIN, ACK, FIN, ACK)</span></p><p><strong><span>TCP 3-Way Handshake Connection Start</span></strong></p><div class="md-diagram-panel"><svg height="255" version="1.1" width="217.34375" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="overflow: hidden; position: relative; left: -0.5px; top: -0.5625px; max-width: 100%; height: auto;" viewBox="0 0 217.34375 255"><desc style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Created with Raphaël 2.2.0</desc><defs style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><marker id="raphael-marker-endblock55-obj8ws23" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="currentColor" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-objd9sui" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="currentColor" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-objnhfd8" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="currentColor" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker></defs><rect x="10" y="20" width="78.171875" height="39" rx="0" ry="0" fill="var(--bg-color)" stroke="currentColor" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="20.1875" y="30" width="58.171875" height="19" rx="0" ry="0" fill="none" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="49.0859375" y="39.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="currentColor" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Client</tspan></text><rect x="10" y="196" width="78.171875" height="39" rx="0" ry="0" fill="var(--bg-color)" stroke="currentColor" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="20.1875" y="206" width="58.171875" height="19" rx="0" ry="0" fill="none" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="49.0859375" y="215.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="currentColor" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Client</tspan></text><path fill="var(--bg-color)" stroke="currentColor" d="M49.0859375,59L49.0859375,196" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="108.171875" y="20" width="79.171875" height="39" rx="0" ry="0" fill="var(--bg-color)" stroke="currentColor" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="118.859375" y="30" width="59.171875" height="19" rx="0" ry="0" fill="none" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="147.7578125" y="39.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="currentColor" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Server</tspan></text><rect x="108.171875" y="196" width="79.171875" height="39" rx="0" ry="0" fill="var(--bg-color)" stroke="currentColor" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="118.859375" y="206" width="59.171875" height="19" rx="0" ry="0" fill="none" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="147.7578125" y="215.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="currentColor" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Server</tspan></text><path fill="var(--bg-color)" stroke="currentColor" d="M147.7578125,59L147.7578125,196" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="83.96875" y="74.5" width="29.28125" height="19" rx="0" ry="0" fill="none" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="98.421875" y="84" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="currentColor" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">SYN</tspan></text><path fill="var(--bg-color)" stroke="currentColor" d="M49.0859375,98C49.0859375,98,122.70480666682124,98,142.7630727777032,98" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj8ws23)" stroke-dasharray="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="64.703125" y="113.5" width="68.8125" height="19" rx="0" ry="0" fill="none" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="98.421875" y="123" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="currentColor" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">SYN/ACK</tspan></text><path fill="var(--bg-color)" stroke="currentColor" d="M147.7578125,137C147.7578125,137,74.13894333317876,137,54.0806772222968,137" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objd9sui)" stroke-dasharray="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="82.96875" y="152.5" width="31.28125" height="19" rx="0" ry="0" fill="none" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="98.421875" y="162" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="currentColor" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">ACK</tspan></text><path fill="var(--bg-color)" stroke="currentColor" d="M49.0859375,176C49.0859375,176,122.70480666682124,176,142.7630727777032,176" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objnhfd8)" stroke-dasharray="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path></svg></div><p><strong><span>TCP 4 -Way Handshake Connection End</span></strong></p><div class="md-diagram-panel"><svg height="294" version="1.1" width="217.34375" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="overflow: hidden; position: relative; left: -0.5px; top: -0.5625px; max-width: 100%; height: auto;" viewBox="0 0 217.34375 294"><desc style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Created with Raphaël 2.2.0</desc><defs style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><marker id="raphael-marker-endblock55-obja3jmy" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="currentColor" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-obj0mr26" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="currentColor" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-objher7i" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="currentColor" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock55-objk03ny" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xlink:href="#raphael-marker-block" transform="rotate(180 2.5 2.5) scale(1,1)" stroke-width="1.0000" fill="currentColor" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker></defs><rect x="10" y="20" width="78.171875" height="39" rx="0" ry="0" fill="var(--bg-color)" stroke="currentColor" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="20.1875" y="30" width="58.171875" height="19" rx="0" ry="0" fill="none" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="49.0859375" y="39.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="currentColor" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Client</tspan></text><rect x="10" y="235" width="78.171875" height="39" rx="0" ry="0" fill="var(--bg-color)" stroke="currentColor" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="20.1875" y="245" width="58.171875" height="19" rx="0" ry="0" fill="none" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="49.0859375" y="254.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="currentColor" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Client</tspan></text><path fill="var(--bg-color)" stroke="currentColor" d="M49.0859375,59L49.0859375,235" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="108.171875" y="20" width="79.171875" height="39" rx="0" ry="0" fill="var(--bg-color)" stroke="currentColor" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="118.859375" y="30" width="59.171875" height="19" rx="0" ry="0" fill="none" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="147.7578125" y="39.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="currentColor" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Server</tspan></text><rect x="108.171875" y="235" width="79.171875" height="39" rx="0" ry="0" fill="var(--bg-color)" stroke="currentColor" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><rect x="118.859375" y="245" width="59.171875" height="19" rx="0" ry="0" fill="none" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="147.7578125" y="254.5" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="currentColor" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Server</tspan></text><path fill="var(--bg-color)" stroke="currentColor" d="M147.7578125,59L147.7578125,235" stroke-width="2" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="83.96875" y="74.5" width="29.28125" height="19" rx="0" ry="0" fill="none" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="98.421875" y="84" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="currentColor" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">FIN</tspan></text><path fill="var(--bg-color)" stroke="currentColor" d="M49.0859375,98C49.0859375,98,122.70480666682124,98,142.7630727777032,98" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obja3jmy)" stroke-dasharray="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="82.96875" y="113.5" width="31.28125" height="19" rx="0" ry="0" fill="none" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="98.421875" y="123" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="currentColor" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">ACK</tspan></text><path fill="var(--bg-color)" stroke="currentColor" d="M147.7578125,137C147.7578125,137,74.13894333317876,137,54.0806772222968,137" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj0mr26)" stroke-dasharray="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="83.96875" y="152.5" width="29.28125" height="19" rx="0" ry="0" fill="none" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="98.421875" y="162" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="currentColor" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">FIN</tspan></text><path fill="var(--bg-color)" stroke="currentColor" d="M147.7578125,176C147.7578125,176,74.13894333317876,176,54.0806772222968,176" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objher7i)" stroke-dasharray="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path><rect x="82.96875" y="191.5" width="31.28125" height="19" rx="0" ry="0" fill="none" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></rect><text x="98.421875" y="201" text-anchor="middle" font-family="Andale Mono, monospace" font-size="16px" stroke="none" fill="currentColor" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: middle; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;"><tspan dy="5.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">ACK</tspan></text><path fill="var(--bg-color)" stroke="currentColor" d="M49.0859375,215C49.0859375,215,122.70480666682124,215,142.7630727777032,215" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objk03ny)" stroke-dasharray="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path></svg></div><p><span>This means that it is easy to tell when a TCP connection starts and ends.  However, stateless protocols (namely UDP) do not have the same property.  There is no official opening to a UDP connection, and the term &quot;connection&quot; can be tricky to apply to UDP at all.  What firewalls and most packet analysis tools do is define a time window (typically 30-60 seconds) during which UDP packets using the same IPs and port numbers are considered part of the same &quot;session&quot;. Each time a new packet is seen the session window TCPtimer is reset. This means that a session is considered started when the first UDP packet is seen and ended when no more UDP packets have been seen for the duration of the time window. The terms &quot;session&quot; and &quot;connection&quot; are often used interchangeably.</span></p><p><span>The following information must remain the same across packets to be considered part of the same session. Though the IP and ports will swap between source and destination depending on which direction the packet is going.</span></p><ul><li><span>source and destination IP addresses</span></li><li><span>source and destination ports</span></li><li><span>protocol</span></li></ul><p><span>Collectively, these pieces of information are commonly referred to as a 5-tuple and used to distinguish individual sessions.</span></p><h2><a name="hunt" class="md-header-anchor"></a><span>Hunt</span></h2><p><span>We&#39;re going to find the connections that have been active for the longest amount of time. These could indicate an attacker with a long-lived C2 session.</span></p><h3><a name="wireshark" class="md-header-anchor"></a><span>Wireshark</span></h3><p><span>Open your pcap in Wireshark. This loads every individual packet in the main window.</span></p><p><span>Under the Statistics menu select Conversations. The Conversations window summarizes all the packets into &quot;conversations&quot;.</span></p><p><span>Select the TCP tab and sort by clicking on the Duration column. Click it again to sort in decreasing order.</span></p><p><img src="Identify Long Connections.assets/1571237791366.png" referrerpolicy="no-referrer" alt="1571237791366"></p><p><span>From here you can see which TCP connections were held open for the longest. In the image above we have a connection from 10.55.100.100 to 65.52.108.255 on port 443 (HTTPS) that was open for 86,222 seconds, or 23.95 hours.</span></p><p><span>Next, select the UDP tab and apply the same sort by clicking on the Duration column twice.</span></p><p><img src="Identify Long Connections.assets/1571237816351.png" referrerpolicy="no-referrer" alt="1571237816351"></p><p><span>Here we have a UDP packets from 192.168.88.2 to 216.299.4.69 on port 123 (NTP) for a duration of 86,217 seconds, or 23.95 hours.</span></p><p><span>However, recall the discussion above about how UDP does not have real &quot;start&quot; and &quot;end&quot; times. Some tools will use a time window to determine when a UDP connection ends. We can see that Wireshark most likely does not do this by looking at the second entry. If you take the total duration (86,209) and divide it by the total number of packets sent (6) we see that there was on average a delay of 14,368 seconds (or about 4 hours) between packets. A time window that broad is useless and it is safe to assume that Wireshark is showing us &quot;conversations&quot; with data from the entire timespan of the packet capture.</span></p><h3><a name="zeek" class="md-header-anchor"></a><span>Zeek</span></h3><p><span>Be sure to </span><a href='Basic Tool Usage.html#process-a-cap'><span>analyze your pcap using Zeek</span></a><span> before starting.</span></p><p><span>Your Zeek logs should include a file called </span><code>conn.log</code><span>. You can inspect what&#39;s in this file using the </span><code>head</code><span> command.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">head conn.log</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><strong><span>Output</span></strong></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#separator \x09</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-comment">#set_separator<span class="cm-tab" role="presentation" cm-text="	">  </span>,</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-comment">#empty_field<span class="cm-tab" role="presentation" cm-text="	">    </span>(empty)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-comment">#unset_field<span class="cm-tab" role="presentation" cm-text="	">    </span>-</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-comment">#path<span class="cm-tab" role="presentation" cm-text="	">   </span>conn</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-comment">#open<span class="cm-tab" role="presentation" cm-text="	">   </span>2019-10-16-15-13-09</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-comment">#fields<span class="cm-tab" role="presentation" cm-text="	"> </span>ts<span class="cm-tab" role="presentation" cm-text="	">  </span>uid<span class="cm-tab" role="presentation" cm-text="	"> </span>id.orig_h<span class="cm-tab" role="presentation" cm-text="	">   </span>id.orig_p<span class="cm-tab" role="presentation" cm-text="	">   </span>id.resp_h<span class="cm-tab" role="presentation" cm-text="	">   </span>id.resp_p<span class="cm-tab" role="presentation" cm-text="	">   </span>proto<span class="cm-tab" role="presentation" cm-text="	">   </span>serviceduration<span class="cm-tab" role="presentation" cm-text="	"> </span>orig_bytes<span class="cm-tab" role="presentation" cm-text="	">  </span>resp_bytes<span class="cm-tab" role="presentation" cm-text="	">  </span>conn_state<span class="cm-tab" role="presentation" cm-text="	">  </span>local_orig<span class="cm-tab" role="presentation" cm-text="	">  </span>local_resp<span class="cm-tab" role="presentation" cm-text="	">  </span>missed_bytes<span class="cm-tab" role="presentation" cm-text="	">    </span>history<span class="cm-tab" role="presentation" cm-text="	"> </span>orig_pkts<span class="cm-tab" role="presentation" cm-text="	">   </span>orig_ip_bytes<span class="cm-tab" role="presentation" cm-text="	">   </span>resp_pkts<span class="cm-tab" role="presentation" cm-text="	">   </span>resp_ip_bytes<span class="cm-tab" role="presentation" cm-text="	">   </span>tunnel_parents</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-comment">#types<span class="cm-tab" role="presentation" cm-text="	">  </span>time<span class="cm-tab" role="presentation" cm-text="	">    </span>string<span class="cm-tab" role="presentation" cm-text="	">  </span>addr<span class="cm-tab" role="presentation" cm-text="	">    </span>port<span class="cm-tab" role="presentation" cm-text="	">    </span>addr<span class="cm-tab" role="presentation" cm-text="	">    </span>port<span class="cm-tab" role="presentation" cm-text="	">    </span>enum<span class="cm-tab" role="presentation" cm-text="	">    </span>string<span class="cm-tab" role="presentation" cm-text="	">  </span>interval<span class="cm-tab" role="presentation" cm-text="	">    </span>count<span class="cm-tab" role="presentation" cm-text="	">   </span>count<span class="cm-tab" role="presentation" cm-text="	">   </span>string<span class="cm-tab" role="presentation" cm-text="	">  </span>bool<span class="cm-tab" role="presentation" cm-text="	">    </span>bool<span class="cm-tab" role="presentation" cm-text="	">    </span>count<span class="cm-tab" role="presentation" cm-text="	">   </span>string<span class="cm-tab" role="presentation" cm-text="	">  </span>count<span class="cm-tab" role="presentation" cm-text="	">   </span>count<span class="cm-tab" role="presentation" cm-text="	">   </span>count<span class="cm-tab" role="presentation" cm-text="	">   </span>count<span class="cm-tab" role="presentation" cm-text="	">   </span>set[string]</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1517336042</span>.090842<span class="cm-tab" role="presentation" cm-text="	">   </span>CW32gzposD5TUDUB<span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">10</span>.55.182.100<span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">14291</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">10</span>.233.233.5<span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">80</span><span class="cm-tab" role="presentation" cm-text="	">  </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-attribute">-3</span>.000158<span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">0</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">0</span><span class="cm-tab" role="presentation" cm-text="	">   </span>S0<span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-attribute">-</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-attribute">-</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">0</span><span class="cm-tab" role="presentation" cm-text="	">   </span>S<span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">2</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">104</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">0</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">0</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-attribute">-</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1517336042</span>.279652<span class="cm-tab" role="presentation" cm-text="	">   </span>ComPBK1vso3uDC8KS2<span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">192</span>.168.88.2<span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">55638</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">165</span>.227.88.15<span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">53</span><span class="cm-tab" role="presentation" cm-text="	">  </span>udp<span class="cm-tab" role="presentation" cm-text="	"> </span>dns<span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">0</span>.069982<span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">61</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">81</span><span class="cm-tab" role="presentation" cm-text="	">  </span>SF<span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-attribute">-</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-attribute">-</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">0</span><span class="cm-tab" role="presentation" cm-text="	">   </span>Dd<span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">1</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">89</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">1</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">109</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-attribute">-</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 368px;"></div><div class="CodeMirror-gutters" style="display: none; height: 368px;"></div></div></div></pre><p><span>This isn&#39;t very readable on it&#39;s own. There are too many columns to display on a single line. Let&#39;s use </span><code>zeek-cut</code><span> to reduce the columns to what we&#39;d like to look at.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">head conn.log | zeek-cut <span class="cm-attribute">-c</span> id.orig_h id.orig_p id.resp_h id.resp_p proto <span class="cm-builtin">service</span> duration</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><strong><span>Output</span></strong></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#separator \x09</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-comment">#set_separator<span class="cm-tab" role="presentation" cm-text="	">  </span>,</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-comment">#empty_field<span class="cm-tab" role="presentation" cm-text="	">    </span>(empty)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-comment">#unset_field<span class="cm-tab" role="presentation" cm-text="	">    </span>-</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-comment">#path<span class="cm-tab" role="presentation" cm-text="	">   </span>conn</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-comment">#open<span class="cm-tab" role="presentation" cm-text="	">   </span>2019-10-16-15-13-09</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-comment">#fields<span class="cm-tab" role="presentation" cm-text="	"> </span>id.orig_h<span class="cm-tab" role="presentation" cm-text="	">   </span>id.orig_p<span class="cm-tab" role="presentation" cm-text="	">   </span>id.resp_h<span class="cm-tab" role="presentation" cm-text="	">   </span>id.resp_p<span class="cm-tab" role="presentation" cm-text="	">   </span>proto<span class="cm-tab" role="presentation" cm-text="	">   </span>service<span class="cm-tab" role="presentation" cm-text="	"> </span>duration</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-comment">#types<span class="cm-tab" role="presentation" cm-text="	">  </span>addr<span class="cm-tab" role="presentation" cm-text="	">    </span>port<span class="cm-tab" role="presentation" cm-text="	">    </span>addr<span class="cm-tab" role="presentation" cm-text="	">    </span>port<span class="cm-tab" role="presentation" cm-text="	">    </span>enum<span class="cm-tab" role="presentation" cm-text="	">    </span>string<span class="cm-tab" role="presentation" cm-text="	">  </span>interval</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">10</span>.55.182.100<span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">14291</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">10</span>.233.233.5<span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">80</span><span class="cm-tab" role="presentation" cm-text="	">  </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-attribute">-</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">3</span>.000158</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">192</span>.168.88.2<span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">55638</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">165</span>.227.88.15<span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">53</span><span class="cm-tab" role="presentation" cm-text="	">  </span>udp<span class="cm-tab" role="presentation" cm-text="	"> </span>dns<span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">0</span>.069982</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 230px;"></div><div class="CodeMirror-gutters" style="display: none; height: 230px;"></div></div></div></pre><p><span>This is better, but so far we are only processing the first few lines of the file. Using </span><code>cat</code><span> instead of </span><code>head</code><span> will show the entire file scroll by.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">cat</span> conn.log | zeek-cut <span class="cm-attribute">-c</span> id.orig_h id.orig_p id.resp_h id.resp_p proto <span class="cm-builtin">service</span> duration</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><strong><span>Output</span></strong></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">...</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.111<span class="cm-tab" role="presentation" cm-text="	">   </span>57481<span class="cm-tab" role="presentation" cm-text="	">   </span>172.217.6.2<span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-tab" role="presentation" cm-text="	">    </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>ssl<span class="cm-tab" role="presentation" cm-text="	"> </span>105.310590</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.111<span class="cm-tab" role="presentation" cm-text="	">   </span>57475<span class="cm-tab" role="presentation" cm-text="	">   </span>198.160.127.57<span class="cm-tab" role="presentation" cm-text="	">  </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>ssl<span class="cm-tab" role="presentation" cm-text="	"> </span>105.614383</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.107<span class="cm-tab" role="presentation" cm-text="	">   </span>51651<span class="cm-tab" role="presentation" cm-text="	">   </span>52.203.62.126<span class="cm-tab" role="presentation" cm-text="	">   </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>ssl<span class="cm-tab" role="presentation" cm-text="	"> </span>14.495950</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.111<span class="cm-tab" role="presentation" cm-text="	">   </span>57447<span class="cm-tab" role="presentation" cm-text="	">   </span>54.215.180.145<span class="cm-tab" role="presentation" cm-text="	">  </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>ssl<span class="cm-tab" role="presentation" cm-text="	"> </span>109.111123</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.100<span class="cm-tab" role="presentation" cm-text="	">   </span>61848<span class="cm-tab" role="presentation" cm-text="	">   </span>205.204.101.182<span class="cm-tab" role="presentation" cm-text="	"> </span>80<span class="cm-tab" role="presentation" cm-text="	">  </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>-<span class="cm-tab" role="presentation" cm-text="	">   </span>106.362057</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.111<span class="cm-tab" role="presentation" cm-text="	">   </span>57461<span class="cm-tab" role="presentation" cm-text="	">   </span>172.217.8.198<span class="cm-tab" role="presentation" cm-text="	">   </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>ssl<span class="cm-tab" role="presentation" cm-text="	"> </span>107.272461</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.111<span class="cm-tab" role="presentation" cm-text="	">   </span>57459<span class="cm-tab" role="presentation" cm-text="	">   </span>172.217.8.198<span class="cm-tab" role="presentation" cm-text="	">   </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>ssl<span class="cm-tab" role="presentation" cm-text="	"> </span>107.268048</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.111<span class="cm-tab" role="presentation" cm-text="	">   </span>57448<span class="cm-tab" role="presentation" cm-text="	">   </span>23.201.85.182<span class="cm-tab" role="presentation" cm-text="	">   </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>ssl<span class="cm-tab" role="presentation" cm-text="	"> </span>108.628962</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.106<span class="cm-tab" role="presentation" cm-text="	">   </span>60207<span class="cm-tab" role="presentation" cm-text="	">   </span>65.52.108.188<span class="cm-tab" role="presentation" cm-text="	">   </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>ssl<span class="cm-tab" role="presentation" cm-text="	"> </span>2340.397545</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.111<span class="cm-tab" role="presentation" cm-text="	">   </span>57477<span class="cm-tab" role="presentation" cm-text="	">   </span>63.140.32.190<span class="cm-tab" role="presentation" cm-text="	">   </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>ssl<span class="cm-tab" role="presentation" cm-text="	"> </span>105.333464</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">192.168.88.2<span class="cm-tab" role="presentation" cm-text="	">    </span>123<span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-tab" role="presentation" cm-text="	">    </span>216.229.4.69<span class="cm-tab" role="presentation" cm-text="	">    </span>123<span class="cm-tab" role="presentation" cm-text="	"> </span>udp<span class="cm-tab" role="presentation" cm-text="	"> </span>ntp<span class="cm-tab" role="presentation" cm-text="	"> </span>0.048235</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 276px;"></div><div class="CodeMirror-gutters" style="display: none; height: 276px;"></div></div></div></pre><p><span>Next, let&#39;s introduce the </span><code>sort</code><span> command.</span></p><ul><li><code>-n</code><span> will sort based on numeric order</span></li><li><code>-r</code><span> will reverse the sort so that the largest numbers are at the top</span></li><li><code>-k 7</code><span> tells sort to use the 7th column, which is our duration column</span></li></ul><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">cat</span> conn.log | zeek-cut id.orig_h id.orig_p id.resp_h id.resp_p proto <span class="cm-builtin">service</span> duration | <span class="cm-builtin">sort</span> <span class="cm-attribute">-nrk</span> <span class="cm-number">7</span> | head</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><p><strong><span>Output</span></strong></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.100<span class="cm-tab" role="presentation" cm-text="	">   </span>49778<span class="cm-tab" role="presentation" cm-text="	">   </span>65.52.108.225<span class="cm-tab" role="presentation" cm-text="	">   </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>-<span class="cm-tab" role="presentation" cm-text="	">   </span>86222.365445</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.107<span class="cm-tab" role="presentation" cm-text="	">   </span>56099<span class="cm-tab" role="presentation" cm-text="	">   </span>111.221.29.113<span class="cm-tab" role="presentation" cm-text="	">  </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>-<span class="cm-tab" role="presentation" cm-text="	">   </span>86220.126151</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.110<span class="cm-tab" role="presentation" cm-text="	">   </span>60168<span class="cm-tab" role="presentation" cm-text="	">   </span>40.77.229.82<span class="cm-tab" role="presentation" cm-text="	">    </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>-<span class="cm-tab" role="presentation" cm-text="	">   </span>86160.119664</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.109<span class="cm-tab" role="presentation" cm-text="	">   </span>53932<span class="cm-tab" role="presentation" cm-text="	">   </span>65.52.108.233<span class="cm-tab" role="presentation" cm-text="	">   </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>ssl<span class="cm-tab" role="presentation" cm-text="	"> </span>72176.131072</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.105<span class="cm-tab" role="presentation" cm-text="	">   </span>60214<span class="cm-tab" role="presentation" cm-text="	">   </span>65.52.108.195<span class="cm-tab" role="presentation" cm-text="	">   </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>ssl<span class="cm-tab" role="presentation" cm-text="	"> </span>66599.002312</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.103<span class="cm-tab" role="presentation" cm-text="	">   </span>49918<span class="cm-tab" role="presentation" cm-text="	">   </span>131.253.34.243<span class="cm-tab" role="presentation" cm-text="	">  </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>-<span class="cm-tab" role="presentation" cm-text="	">   </span>64698.370547</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.104<span class="cm-tab" role="presentation" cm-text="	">   </span>63530<span class="cm-tab" role="presentation" cm-text="	">   </span>131.253.34.246<span class="cm-tab" role="presentation" cm-text="	">  </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>ssl<span class="cm-tab" role="presentation" cm-text="	"> </span>57413.278323</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.111<span class="cm-tab" role="presentation" cm-text="	">   </span>63029<span class="cm-tab" role="presentation" cm-text="	">   </span>111.221.29.114<span class="cm-tab" role="presentation" cm-text="	">  </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>-<span class="cm-tab" role="presentation" cm-text="	">   </span>46638.510373</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.108<span class="cm-tab" role="presentation" cm-text="	">   </span>52989<span class="cm-tab" role="presentation" cm-text="	">   </span>65.52.108.220<span class="cm-tab" role="presentation" cm-text="	">   </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>-<span class="cm-tab" role="presentation" cm-text="	">   </span>44615.165823</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.106<span class="cm-tab" role="presentation" cm-text="	">   </span>52918<span class="cm-tab" role="presentation" cm-text="	">   </span>40.77.229.91<span class="cm-tab" role="presentation" cm-text="	">    </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>ssl<span class="cm-tab" role="presentation" cm-text="	"> </span>41206.913035</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 230px;"></div><div class="CodeMirror-gutters" style="display: none; height: 230px;"></div></div></div></pre><p><span>We are piping the contents of </span><code>conn.log</code><span> into </span><code>zeek-cut</code><span> which is reducing the number of fields to only show the ones we care about. Next we are using </span><code>sort</code><span> to sort the lines by the duration. And finally we are using </span><code>head</code><span> to only show us the top 10 entries.</span></p><p><span>From here you can see which TCP connections were held open for the longest. In the output above we have a connection from 10.55.100.100 to 65.52.108.255 on port 443 that was open for 86,222 seconds, or 23.95 hours.</span></p><p><span>Note that the </span><code>conn.log</code><span> shows connections for TCP, UDP, and ICMP all in the same file. So the above command is giving us the longest connections across all these protocols. If we wanted to filter out and see only the longest UDP connection, we use </span><code>grep</code><span> before the </span><code>sort</code><span>.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">cat</span> conn.log | zeek-cut id.orig_h id.orig_p id.resp_h id.resp_p proto <span class="cm-builtin">service</span> duration | <span class="cm-builtin">grep</span> udp | <span class="cm-builtin">sort</span> <span class="cm-attribute">-nrk</span> <span class="cm-number">7</span> | head</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><p><strong><span>Output</span></strong></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.182.100<span class="cm-tab" role="presentation" cm-text="	">   </span>63546<span class="cm-tab" role="presentation" cm-text="	">   </span>96.45.33.73<span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-tab" role="presentation" cm-text="	">    </span>8888<span class="cm-tab" role="presentation" cm-text="	">    </span>udp<span class="cm-tab" role="presentation" cm-text="	"> </span>-<span class="cm-tab" role="presentation" cm-text="	">   </span>99.087045</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.182.100<span class="cm-tab" role="presentation" cm-text="	">   </span>59685<span class="cm-tab" role="presentation" cm-text="	">   </span>172.217.8.196<span class="cm-tab" role="presentation" cm-text="	">   </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-tab" role="presentation" cm-text="	">    </span>udp<span class="cm-tab" role="presentation" cm-text="	"> </span>-<span class="cm-tab" role="presentation" cm-text="	">   </span>59.539003</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.182.100<span class="cm-tab" role="presentation" cm-text="	">   </span>63546<span class="cm-tab" role="presentation" cm-text="	">   </span>96.45.33.73<span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-tab" role="presentation" cm-text="	">    </span>8888<span class="cm-tab" role="presentation" cm-text="	">    </span>udp<span class="cm-tab" role="presentation" cm-text="	"> </span>-<span class="cm-tab" role="presentation" cm-text="	">   </span>59.322097</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.182.100<span class="cm-tab" role="presentation" cm-text="	">   </span>63546<span class="cm-tab" role="presentation" cm-text="	">   </span>96.45.33.73<span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-tab" role="presentation" cm-text="	">    </span>8888<span class="cm-tab" role="presentation" cm-text="	">    </span>udp<span class="cm-tab" role="presentation" cm-text="	"> </span>-<span class="cm-tab" role="presentation" cm-text="	">   </span>56.383127</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.182.100<span class="cm-tab" role="presentation" cm-text="	">   </span>63546<span class="cm-tab" role="presentation" cm-text="	">   </span>96.45.33.73<span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-tab" role="presentation" cm-text="	">    </span>8888<span class="cm-tab" role="presentation" cm-text="	">    </span>udp<span class="cm-tab" role="presentation" cm-text="	"> </span>-<span class="cm-tab" role="presentation" cm-text="	">   </span>55.771569</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.182.100<span class="cm-tab" role="presentation" cm-text="	">   </span>63546<span class="cm-tab" role="presentation" cm-text="	">   </span>96.45.33.73<span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-tab" role="presentation" cm-text="	">    </span>8888<span class="cm-tab" role="presentation" cm-text="	">    </span>udp<span class="cm-tab" role="presentation" cm-text="	"> </span>-<span class="cm-tab" role="presentation" cm-text="	">   </span>54.537906</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.182.100<span class="cm-tab" role="presentation" cm-text="	">   </span>59690<span class="cm-tab" role="presentation" cm-text="	">   </span>172.217.4.34<span class="cm-tab" role="presentation" cm-text="	">    </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-tab" role="presentation" cm-text="	">    </span>udp<span class="cm-tab" role="presentation" cm-text="	"> </span>-<span class="cm-tab" role="presentation" cm-text="	">   </span>53.620681</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.182.100<span class="cm-tab" role="presentation" cm-text="	">   </span>63546<span class="cm-tab" role="presentation" cm-text="	">   </span>96.45.33.73<span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-tab" role="presentation" cm-text="	">    </span>8888<span class="cm-tab" role="presentation" cm-text="	">    </span>udp<span class="cm-tab" role="presentation" cm-text="	"> </span>-<span class="cm-tab" role="presentation" cm-text="	">   </span>51.529226</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.182.100<span class="cm-tab" role="presentation" cm-text="	">   </span>63546<span class="cm-tab" role="presentation" cm-text="	">   </span>96.45.33.73<span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-tab" role="presentation" cm-text="	">    </span>8888<span class="cm-tab" role="presentation" cm-text="	">    </span>udp<span class="cm-tab" role="presentation" cm-text="	"> </span>-<span class="cm-tab" role="presentation" cm-text="	">   </span>51.355111</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.182.100<span class="cm-tab" role="presentation" cm-text="	">   </span>63546<span class="cm-tab" role="presentation" cm-text="	">   </span>96.45.33.73<span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-tab" role="presentation" cm-text="	">    </span>8888<span class="cm-tab" role="presentation" cm-text="	">    </span>udp<span class="cm-tab" role="presentation" cm-text="	"> </span>-<span class="cm-tab" role="presentation" cm-text="	">   </span>48.440549</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 230px;"></div><div class="CodeMirror-gutters" style="display: none; height: 230px;"></div></div></div></pre><p><span>Here we can see that the UDP long connection results from Zeek differ from what we get if we use Wireshark. This is because Zeek uses a </span><a href='https://github.com/zeek/zeek/blob/5265613a9ecc9cb09a7c16cbe378a320903fbcd2/scripts/base/init-bare.zeek#L981'><span>1 minute</span></a><span> inactivity timeout when analyzing a UDP connection, while Wireshark did not use a timeout.</span></p><h4><a name="cummulative-long-connections" class="md-header-anchor"></a><span>Cummulative Long Connections</span></h4><p><span>In some cases, malware might exhibit behavior that is somewhere between a single long connection, or a short, frequent beacon interval. Instead, it might open a connection, hold it open for a period of time (e.g. 30 minutes), and then immediately open another connection, and repeat.</span></p><p><span>The image below illustrates the difference by showing one single connection held open for 24 hours on top compared to 6 individual connections spread out over the 24 hours.</span></p><p><img src="Long Connections.assets/cummulative vs long.png" referrerpolicy="no-referrer" alt="cummulative vs long"></p><p><span>With this, an attacker is still able to maintain persistent communication for a long period of time but might not show up in the type of long connection analysis we&#39;ve done so far. The following command will print the cummulative connection time from one IP address to the same destination IP and port.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">cat</span> conn.log | zeek-cut id.orig_h id.resp_h id.resp_p proto duration | <span class="cm-builtin">awk</span> <span class="cm-string">'BEGIN{ FS="\t" } { arr[$1 FS $2 FS $3 FS $4] += $5 } END{ for (key in arr) printf "%s%s%s\n", key, FS, arr[key] }'</span> | <span class="cm-builtin">sort</span> <span class="cm-attribute">-nrk</span> <span class="cm-number">5</span> | head</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre><p><strong><span>Output</span></strong></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.100<span class="cm-tab" role="presentation" cm-text="	">   </span>65.52.108.225<span class="cm-tab" role="presentation" cm-text="	">   </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>86222.4</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.107<span class="cm-tab" role="presentation" cm-text="	">   </span>111.221.29.113<span class="cm-tab" role="presentation" cm-text="	">  </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>86220.1</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.110<span class="cm-tab" role="presentation" cm-text="	">   </span>40.77.229.82<span class="cm-tab" role="presentation" cm-text="	">    </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>86160.1</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.109<span class="cm-tab" role="presentation" cm-text="	">   </span>65.52.108.233<span class="cm-tab" role="presentation" cm-text="	">   </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>72176.1</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.105<span class="cm-tab" role="presentation" cm-text="	">   </span>65.52.108.195<span class="cm-tab" role="presentation" cm-text="	">   </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>66599</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.103<span class="cm-tab" role="presentation" cm-text="	">   </span>131.253.34.243<span class="cm-tab" role="presentation" cm-text="	">  </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>64698.4</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.104<span class="cm-tab" role="presentation" cm-text="	">   </span>131.253.34.246<span class="cm-tab" role="presentation" cm-text="	">  </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>57413.3</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.111<span class="cm-tab" role="presentation" cm-text="	">   </span>172.217.8.198<span class="cm-tab" role="presentation" cm-text="	">   </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>55728.1</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.111<span class="cm-tab" role="presentation" cm-text="	">   </span>111.221.29.114<span class="cm-tab" role="presentation" cm-text="	">  </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>46658.4</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.108<span class="cm-tab" role="presentation" cm-text="	">   </span>65.52.108.220<span class="cm-tab" role="presentation" cm-text="	">   </span>443<span class="cm-tab" role="presentation" cm-text="	"> </span>tcp<span class="cm-tab" role="presentation" cm-text="	"> </span>44615.2</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 230px;"></div><div class="CodeMirror-gutters" style="display: none; height: 230px;"></div></div></div></pre><p><code>awk</code><span> is a powerful scripting tool. However, the syntax starts to get very messy all on one line like this.</span></p><ul><li><code>BEGIN{ FS=&quot;\t&quot; }</code><span>  - Set the </span><code>FS</code><span> (field separator) variable to a tab character. This is what is separating columns in our Zeek logs as well as what we want to use in our output. </span><code>BEGIN</code><span> means this instruction is only executed one time, before any data is processed.</span></li><li><code>{ arr[$1 FS $2 FS $3 FS $4] += $5 }</code><span> - Creates an array (named </span><code>arr</code><span>) and adds up the duration (</span><code>$5</code><span> is the fifth field, which is our duration). The important part here is that we are using the concatenation of the first four fields (</span><code>$1</code><span> through </span><code>$4</code><span>) as our array key. Which means that as long as the source and destination IPs, destination port, and protocol remain the same it will add the duration to the total. </span><code>awk</code><span> executes this instruction repeatedly for every line of data.</span></li><li><code>END{ for (key in arr) printf &quot;%s%s%s\n&quot;, key, FS, arr[key] }</code><span> - Here we are looping through all the elements in the array and printing out the results. </span><code>END</code><span> signifies that </span><code>awk</code><span> only executes this instruction one time, after processing all the data.</span></li></ul><p><span>The results we get in this dataset are very similar to the results of overall long connections from the previous section. However, notice that previously there was no long connection from </span><code>10.55.100.111</code><span> to </span><code>172.217.8.198</code><span> in our top long connections. But here we can see that there were enough individual connections to bring it into our top 10.</span></p><p><span>Let&#39;s modify our command to:</span></p><ol start='' ><li><span>Disregard the destination port and protocol. If two IPs are directly communicating at all, no matter how, we want to know. This will catch cases where malware is switching between multiple ports or protocols on the same IP.</span></li><li><span>Print out the number of connections that contributed to the overall duration. This will help us distinguish entries where there was a single long connection from those which had multiple connections.</span></li></ol><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">cat</span> conn.log | zeek-cut id.orig_h id.resp_h duration | <span class="cm-builtin">awk</span> <span class="cm-string">'BEGIN{ FS="\t" } { arr[$1 FS $2] += $3; count[$1 FS $2] += 1 } END{ for (key in arr) printf "%s%s%s%s%s\n", key, FS, count[key], FS, arr[key] }'</span> | <span class="cm-builtin">sort</span> <span class="cm-attribute">-nrk</span> <span class="cm-number">4</span> | head</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre><p><strong><span>Output</span></strong></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.100<span class="cm-tab" role="presentation" cm-text="	">   </span>65.52.108.225<span class="cm-tab" role="presentation" cm-text="	">   </span>1<span class="cm-tab" role="presentation" cm-text="	">   </span>86222.4</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.107<span class="cm-tab" role="presentation" cm-text="	">   </span>111.221.29.113<span class="cm-tab" role="presentation" cm-text="	">  </span>1<span class="cm-tab" role="presentation" cm-text="	">   </span>86220.1</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.110<span class="cm-tab" role="presentation" cm-text="	">   </span>40.77.229.82<span class="cm-tab" role="presentation" cm-text="	">    </span>1<span class="cm-tab" role="presentation" cm-text="	">   </span>86160.1</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.109<span class="cm-tab" role="presentation" cm-text="	">   </span>65.52.108.233<span class="cm-tab" role="presentation" cm-text="	">   </span>1<span class="cm-tab" role="presentation" cm-text="	">   </span>72176.1</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.105<span class="cm-tab" role="presentation" cm-text="	">   </span>65.52.108.195<span class="cm-tab" role="presentation" cm-text="	">   </span>1<span class="cm-tab" role="presentation" cm-text="	">   </span>66599</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.103<span class="cm-tab" role="presentation" cm-text="	">   </span>131.253.34.243<span class="cm-tab" role="presentation" cm-text="	">  </span>1<span class="cm-tab" role="presentation" cm-text="	">   </span>64698.4</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.104<span class="cm-tab" role="presentation" cm-text="	">   </span>131.253.34.246<span class="cm-tab" role="presentation" cm-text="	">  </span>1<span class="cm-tab" role="presentation" cm-text="	">   </span>57413.3</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.111<span class="cm-tab" role="presentation" cm-text="	">   </span>172.217.8.198<span class="cm-tab" role="presentation" cm-text="	">   </span>543<span class="cm-tab" role="presentation" cm-text="	"> </span>56057.3</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.111<span class="cm-tab" role="presentation" cm-text="	">   </span>111.221.29.114<span class="cm-tab" role="presentation" cm-text="	">  </span>2<span class="cm-tab" role="presentation" cm-text="	">   </span>46658.4</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">10.55.100.108<span class="cm-tab" role="presentation" cm-text="	">   </span>65.52.108.220<span class="cm-tab" role="presentation" cm-text="	">   </span>1<span class="cm-tab" role="presentation" cm-text="	">   </span>44615.2</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 230px;"></div><div class="CodeMirror-gutters" style="display: none; height: 230px;"></div></div></div></pre><p><span>We can see that the results didn&#39;t change even when we disregarded protocols and ports. However, now we can see that that pair from </span><code>10.55.100.111</code><span> to </span><code>172.217.8.198</code><span> had 543 separate connections where the rest of the list had 1 or 2. By dividing 56057 seconds by 543 connections we can see that each connection was open for an average of 103 seconds. If we wanted to investigate further, we could look at these individual connections&#39; timing and duration or even perform some simple statistical analysis like we do in </span><a href='Beacons.html'><span>Beacons</span></a><span> to see if there is any regularity or patterns in these connections.</span></p><h3><a name="rita" class="md-header-anchor"></a><span>RITA</span></h3><p><span>RITA uses Zeek logs and should give us the same results as looking at the log files directly as we did above. If you haven&#39;t already, import your log files as described in the </span><a href='Basic Tool Usage.html#import-zeek-logs'><span>Basic Tool Usage</span></a><span> document.</span></p><p><span>The dataset name in this example is &quot;sample&quot;.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">rita show-long-connections <span class="cm-attribute">-H</span> <span class="cm-attribute">--limit</span> <span class="cm-number">10</span> sample</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><strong><span>Output</span></strong></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+---------------+----------------+--------------------------+----------+</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">| &nbsp; SOURCE IP &nbsp; | DESTINATION IP | DSTPORT:PROTOCOL:SERVICE | DURATION |</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+---------------+----------------+--------------------------+----------+</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">| 10.55.100.100 | 65.52.108.225  | 443:tcp:- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  | 86222.4s |</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">| 10.55.100.107 | 111.221.29.113 | 443:tcp:- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  | 86220.1s |</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">| 10.55.100.110 | 40.77.229.82 &nbsp; | 443:tcp:- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  | 86160.1s |</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">| 10.55.100.109 | 65.52.108.233  | 443:tcp:ssl &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  | 72176.1s |</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">| 10.55.100.105 | 65.52.108.195  | 443:tcp:ssl &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  | 66599s &nbsp; |</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">| 10.55.100.103 | 131.253.34.243 | 443:tcp:- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  | 64698.4s |</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">| 10.55.100.104 | 131.253.34.246 | 443:tcp:ssl &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  | 57413.3s |</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">| 10.55.100.111 | 111.221.29.114 | 443:tcp:- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  | 46638.5s |</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">| 10.55.100.108 | 65.52.108.220  | 443:tcp:- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  | 44615.2s |</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">| 10.55.100.106 | 40.77.229.91 &nbsp; | 443:tcp:ssl &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  | 41206.9s |</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">+---------------+----------------+--------------------------+----------+</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 322px;"></div><div class="CodeMirror-gutters" style="display: none; height: 322px;"></div></div></div></pre><p><span>Note that RITA will lump together TCP, UDP, and ICMP connections as they are in Zeek&#39;s </span><code>conn.log</code><span> and there is no way to separate out results by protocol using RITA.</span></p></div>
</body>
</html>